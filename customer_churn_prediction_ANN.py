# -*- coding: utf-8 -*-
"""Customer Churn Prediction (ANN).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1zAgvjHjjABYAvmE0nh98gPACNjVu8Ir7

`Customer Churn Dataset` is a classification Dataset. It predicts which customer leaves the bank. It is `binary class` problem

It has 14 columns and around 10K rows
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import tensorflow as tf
from tensorflow import keras

df= pd.read_csv("Churn_Modelling.csv")
df.head()

df.shape

df.columns

df.info()

print(df.duplicated().sum())

print(df['Exited'].value_counts())
print("\n")
print(df['Geography'].value_counts())
print("\n")
print(df['Gender'].value_counts())

df.drop(columns=['RowNumber'], axis=1, inplace=True)

df.drop(columns=['Surname','CustomerId'], axis=1, inplace=True)

df.head()

X=df.drop(columns=['Exited'])
y=df['Exited']

df = pd.get_dummies(df,columns=['Geography','Gender'],drop_first=True)

df.head()

from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test=train_test_split(X,y, test_size=0.2, random_state=41)

from sklearn.preprocessing import StandardScaler
scaler=StandardScaler()

X_train_encoded = pd.get_dummies(X_train, columns=['Geography', 'Gender'], drop_first=True)
X_test_encoded = pd.get_dummies(X_test, columns=['Geography', 'Gender'], drop_first=True)

X_train_trf=scaler.fit_transform(X_train_encoded)
X_test_trf= scaler.transform(X_test_encoded)

from tensorflow.keras import Sequential
from tensorflow.keras.layers import Dense

model=Sequential()

model.add(Dense(11, activation='sigmoid', input_dim=11))
model.add(Dense(11, activation='sigmoid'))
model.add(Dense(1, activation='sigmoid'))

model.summary()

model.compile(optimizer='Adam', loss='binary_crossentropy', metrics=['accuracy'])

history=model.fit(X_train_trf,y_train, batch_size=50, epochs=100, verbose=1, validation_split=0.2)

y_pred = model.predict(X_test_trf)

from sklearn.metrics import accuracy_score
y_pred_binary = (y_pred > 0.5).astype(int)
accuracy_score(y_test, y_pred_binary)

plt.plot(history.history['loss'])
plt.plot(history.history['val_loss'])

plt.plot(history.history['accuracy'])
plt.plot(history.history['val_accuracy'])

